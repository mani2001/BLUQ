2025-12-06 19:52:25 - __main__ - INFO - Starting benchmark run
2025-12-06 19:52:25 - __main__ - INFO - Log file: outputs/results/logs/benchmark_20251206_195225.log
2025-12-06 19:52:25 - __main__ - INFO - Mode: short, Samples: 100
2025-12-06 19:52:25 - __main__ - INFO - Models: ['tinyllama-1.1b']
2025-12-06 19:52:25 - __main__ - INFO - Tasks: ['qa']
2025-12-06 19:52:25 - __main__ - INFO - Dtypes: ['float16']
2025-12-06 19:52:31 - __main__ - INFO - Running on: Device: NVIDIA A100 80GB PCIe (cuda)
  Total Memory: 79.25 GB
  Available Memory: 79.25 GB
2025-12-06 19:52:31 - src.utils.gpu - INFO - Detected A100 GPU: NVIDIA A100 80GB PCIe - using optimized A100 settings
2025-12-06 19:52:31 - __main__ - INFO - GPU Tier: a100 | Auto max_batch_size: 192 | Safety margin: 0.93
2025-12-06 19:52:31 - __main__ - INFO - Auto-detected max_batch_size: 192
2025-12-06 19:52:31 - src.utils.gpu - INFO - Detected A100 GPU: NVIDIA A100 80GB PCIe - using optimized A100 settings
2025-12-06 19:52:31 - src.utils.gpu - INFO - Initialized GPUMemoryManager:
Device: NVIDIA A100 80GB PCIe (cuda)
  Total Memory: 79.25 GB
  Available Memory: 79.25 GB
  GPU Tier: a100
  Safety Margin: 0.93
  Activation Multiplier: 0.4
  Max Batch Size: 192
2025-12-06 19:52:31 - src.utils.gpu - INFO - GPUProfiler initialized (CUDA: True, NVML: False)
2025-12-06 19:52:31 - src.utils.gpu - INFO - Started GPU monitoring
2025-12-06 19:52:31 - __main__ - INFO - GPU profiling enabled
2025-12-06 19:52:31 - __main__ - INFO - 
================================================================================
2025-12-06 19:52:31 - __main__ - INFO - FULL BENCHMARK CONFIGURATION
2025-12-06 19:52:31 - __main__ - INFO - ================================================================================
2025-12-06 19:52:31 - __main__ - INFO - Models (1): ['tinyllama-1.1b']
2025-12-06 19:52:31 - __main__ - INFO - Tasks (1): ['qa']
2025-12-06 19:52:31 - __main__ - INFO - Data types: ['float16']
2025-12-06 19:52:31 - __main__ - INFO - Samples per task: 100
2025-12-06 19:52:31 - __main__ - INFO - Alpha (error rate): 0.1
2025-12-06 19:52:31 - __main__ - INFO - Strategies: ['base']
2025-12-06 19:52:31 - __main__ - INFO - Conformal methods: ['lac', 'aps']
2025-12-06 19:52:31 - __main__ - INFO - Dynamic batch sizing: True
2025-12-06 19:52:31 - __main__ - INFO - Max batch size: 192 (GPU tier: a100)
2025-12-06 19:52:31 - __main__ - INFO - Output directory: outputs/results
2025-12-06 19:52:31 - __main__ - INFO - 
================================================================================
2025-12-06 19:52:31 - __main__ - INFO - Run 1/1: tinyllama-1.1b | qa | float16
2025-12-06 19:52:31 - __main__ - INFO - ================================================================================
2025-12-06 19:52:39 - src.utils.gpu - INFO - [start_tinyllama-1.1b_qa] GPU State: Allocated: 0.0MB | Reserved: 0.0MB | Free: 81152.8MB | Utilization: N/A
2025-12-06 19:52:39 - __main__ - INFO - Loading qa dataset (100 samples)...
2025-12-06 19:52:39 - src.data.dataset_loader - INFO - Loading MMLU dataset with 100 samples...
2025-12-06 19:54:31 - src.data.dataset_loader - INFO - Loaded 100 MMLU instances
2025-12-06 19:54:31 - src.utils.gpu - INFO - [dataset_loading] Duration: 111719.57ms | GPU Memory: 0.0MB -> 0.0MB (delta +0.0MB)
2025-12-06 19:54:31 - src.data.dataset_processor - INFO - Processing qa dataset to 6-option format...
2025-12-06 19:54:31 - src.data.dataset_processor - INFO - Processed 100 instances for qa
2025-12-06 19:54:31 - src.data.data_splitter - INFO - Splitting qa dataset (calibration: 50%, test: 50%)
2025-12-06 19:54:31 - src.data.data_splitter - INFO - Split complete:
2025-12-06 19:54:31 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 19:54:31 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 19:54:31 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 19:54:31 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 12, 'C': 12, 'D': 12}
2025-12-06 19:54:31 - src.data.data_splitter - INFO -   Test: {'A': 14, 'B': 13, 'C': 12, 'D': 12}
2025-12-06 19:54:31 - src.utils.gpu - INFO - [dataset_processing] Duration: 3.19ms | GPU Memory: 0.0MB -> 0.0MB (delta +0.0MB)
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 19:54:31 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for qa
2025-12-06 19:54:31 - __main__ - INFO - Loading model: tinyllama-1.1b (float16)
2025-12-06 19:54:31 - src.models.model_loader - INFO - Loading model: tinyllama-1.1b_float16 (TinyLlama/TinyLlama-1.1B-Chat-v1.0)
2025-12-06 19:54:31 - src.models.model_loader - INFO - Loading tokenizer from TinyLlama/TinyLlama-1.1B-Chat-v1.0
2025-12-06 19:56:39 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 19:56:39 - src.models.model_loader - INFO -   Vocab size: 32000
2025-12-06 19:56:39 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 19:56:39 - src.models.model_loader - INFO -   PAD token: </s> (ID: 2)
2025-12-06 19:56:39 - src.models.model_loader - INFO - Loading model from TinyLlama/TinyLlama-1.1B-Chat-v1.0
2025-12-06 19:56:44 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 19:56:47 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 19:56:47 - src.models.model_loader - INFO -   GPU Memory: 2.05GB allocated, 2.19GB reserved
2025-12-06 19:56:47 - src.utils.gpu - INFO - [model_loading] Duration: 136332.22ms | GPU Memory: 0.0MB -> 2098.2MB (delta +2098.2MB)
2025-12-06 19:56:47 - src.utils.gpu - INFO - [after_model_load_tinyllama-1.1b] GPU State: Allocated: 2098.2MB | Reserved: 2238.0MB | Free: 79054.6MB | Utilization: N/A
2025-12-06 19:56:47 - src.utils.gpu - INFO - Optimal batch size for 1.1B model (float16): 81
  Available memory: 73.70GB
  Model memory: 2.20GB
  Memory per batch item: 0.880GB
2025-12-06 19:56:47 - __main__ - INFO - Using batch size: 81
2025-12-06 19:56:47 - __main__ - INFO -   Strategy: base
2025-12-06 19:56:47 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: qa
2025-12-06 19:56:47 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 19:56:47 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 19:56:47 - src.models.inference_engine - INFO - Initialized InferenceEngine for tinyllama-1.1b_float16
2025-12-06 19:56:47 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 19:56:47 - src.models.inference_engine - INFO -   Batch size: 81
2025-12-06 19:56:47 - src.models.inference_engine - INFO -   Option tokens: {'A': 319, 'B': 350, 'C': 315, 'D': 360, 'E': 382, 'F': 383}
2025-12-06 19:56:49 - src.utils.gpu - INFO - [inference_calibration] Duration: 1976.26ms | GPU Memory: 2098.2MB -> 2106.3MB (delta +8.1MB)
2025-12-06 19:56:50 - src.utils.gpu - INFO - [inference_test] Duration: 1429.63ms | GPU Memory: 2106.3MB -> 2106.3MB (delta +0.0MB)
2025-12-06 19:56:50 - __main__ - INFO -     Inference: 3.41s for 100 samples (29.34 samples/sec)
2025-12-06 19:56:50 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 19:56:50 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 19:56:50 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 19:56:50 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.58ms | GPU Memory: 2106.3MB -> 2106.3MB (delta +0.0MB)
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 19:56:50 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Threshold: 0.9806
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Score range: [0.0548, 0.9999]
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Average set size: 5.65
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 19:56:50 - __main__ - INFO -     LAC: Acc=23.53%, CR=96.08%, SS=5.65
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 19:56:50 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Threshold: 1.0000
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Score range: [0.3230, 1.0000]
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 19:56:50 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Average set size: 6.00
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 19:56:50 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 19:56:50 - __main__ - INFO -     APS: Acc=23.53%, CR=100.00%, SS=6.00
2025-12-06 19:56:55 - src.models.model_loader - INFO - Unloaded model: tinyllama-1.1b_float16
2025-12-06 19:56:55 - __main__ - INFO - Checkpoint saved after completing: tinyllama-1.1b | qa | float16
2025-12-06 19:56:56 - matplotlib.font_manager - INFO - generated new fontManager
2025-12-06 19:56:56 - src.visualization.result_visualizer - INFO - Generating all visualizations...
2025-12-06 19:56:57 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_accuracy.png
2025-12-06 19:56:57 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_coverage_rate.png
2025-12-06 19:56:57 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_avg_set_size.png
2025-12-06 19:56:59 - src.visualization.result_visualizer - INFO - Saved dashboard to outputs/results/figures/dashboard.png
2025-12-06 19:56:59 - src.visualization.result_visualizer - INFO - Saved bar chart to outputs/results/figures/bar_comparison_accuracy.png
2025-12-06 19:56:59 - src.visualization.result_visualizer - INFO - Saved bar chart to outputs/results/figures/bar_comparison_avg_set_size.png
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - Saved radar chart to outputs/results/figures/radar_chart.png
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - Saved uncertainty analysis to outputs/results/figures/uncertainty_analysis.png
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary.md
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary_lac.md
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary_aps.md
2025-12-06 19:57:00 - src.visualization.result_visualizer - INFO - All visualizations saved to outputs/results/figures
2025-12-06 19:57:00 - __main__ - INFO - Visualizations saved to: outputs/results/figures
2025-12-06 19:57:02 - src.utils.gpu - INFO - Stopped GPU monitoring. Collected 135 snapshots.
2025-12-06 19:57:02 - src.utils.gpu - INFO - Saved GPU profiling report to outputs/results/gpu_profile_20251206_195225.json
2025-12-06 19:57:02 - __main__ - INFO - GPU profiling report saved to: outputs/results/gpu_profile_20251206_195225.json
2025-12-06 19:57:02 - __main__ - INFO - 
================================================================================
2025-12-06 19:57:02 - __main__ - INFO - BENCHMARK COMPLETE
2025-12-06 19:57:02 - __main__ - INFO - ================================================================================
2025-12-06 19:57:02 - __main__ - INFO - Total time: 4.40 minutes
2025-12-06 19:57:02 - __main__ - INFO - Results saved to: outputs/results
2025-12-06 19:57:02 - __main__ - INFO - Benchmark completed successfully
2025-12-06 19:57:02 - __main__ - INFO - Total runs: 2
2025-12-06 19:57:02 - __main__ - INFO - Overall accuracy: 23.53%
2025-12-06 19:57:02 - __main__ - INFO - Overall coverage: 98.04%
2025-12-06 19:57:02 - __main__ - INFO - Log file saved to: outputs/results/logs/benchmark_20251206_195225.log
