2025-12-06 20:28:34 - __main__ - INFO - Starting benchmark run
2025-12-06 20:28:34 - __main__ - INFO - Log file: outputs/results/logs/benchmark_20251206_202834.log
2025-12-06 20:28:34 - __main__ - INFO - Mode: short, Samples: 100
2025-12-06 20:28:34 - __main__ - INFO - Models: ['stablelm-2-1.6b']
2025-12-06 20:28:34 - __main__ - INFO - Tasks: ['qa', 'rc', 'ci', 'drs', 'ds']
2025-12-06 20:28:34 - __main__ - INFO - Dtypes: ['float16', 'float32']
2025-12-06 20:28:42 - __main__ - INFO - Running on: Device: NVIDIA A100 80GB PCIe (cuda)
  Total Memory: 79.25 GB
  Available Memory: 79.25 GB
2025-12-06 20:28:42 - src.utils.gpu - INFO - Detected A100 GPU: NVIDIA A100 80GB PCIe - using optimized A100 settings
2025-12-06 20:28:42 - __main__ - INFO - GPU Tier: a100 | Auto max_batch_size: 192 | Safety margin: 0.93
2025-12-06 20:28:42 - __main__ - INFO - Auto-detected max_batch_size: 192
2025-12-06 20:28:42 - src.utils.gpu - INFO - Detected A100 GPU: NVIDIA A100 80GB PCIe - using optimized A100 settings
2025-12-06 20:28:42 - src.utils.gpu - INFO - Initialized GPUMemoryManager:
Device: NVIDIA A100 80GB PCIe (cuda)
  Total Memory: 79.25 GB
  Available Memory: 79.25 GB
  GPU Tier: a100
  Safety Margin: 0.93
  Activation Multiplier: 0.4
  Max Batch Size: 192
2025-12-06 20:28:42 - src.utils.gpu - INFO - NVML initialized for GPU utilization monitoring
2025-12-06 20:28:42 - src.utils.gpu - INFO - GPUProfiler initialized (CUDA: True, NVML: True)
2025-12-06 20:28:42 - src.utils.gpu - INFO - Started GPU monitoring
2025-12-06 20:28:42 - __main__ - INFO - GPU profiling enabled
2025-12-06 20:28:42 - __main__ - INFO - 
================================================================================
2025-12-06 20:28:42 - __main__ - INFO - FULL BENCHMARK CONFIGURATION
2025-12-06 20:28:42 - __main__ - INFO - ================================================================================
2025-12-06 20:28:42 - __main__ - INFO - Models (1): ['stablelm-2-1.6b']
2025-12-06 20:28:42 - __main__ - INFO - Tasks (5): ['qa', 'rc', 'ci', 'drs', 'ds']
2025-12-06 20:28:42 - __main__ - INFO - Data types: ['float16', 'float32']
2025-12-06 20:28:42 - __main__ - INFO - Samples per task: 100
2025-12-06 20:28:42 - __main__ - INFO - Alpha (error rate): 0.1
2025-12-06 20:28:42 - __main__ - INFO - Strategies: ['base']
2025-12-06 20:28:42 - __main__ - INFO - Conformal methods: ['lac', 'aps']
2025-12-06 20:28:42 - __main__ - INFO - Dynamic batch sizing: True
2025-12-06 20:28:42 - __main__ - INFO - Max batch size: 192 (GPU tier: a100)
2025-12-06 20:28:42 - __main__ - INFO - Output directory: outputs/results
2025-12-06 20:28:42 - __main__ - INFO - 
================================================================================
2025-12-06 20:28:42 - __main__ - INFO - Run 1/10: stablelm-2-1.6b | qa | float16
2025-12-06 20:28:42 - __main__ - INFO - ================================================================================
2025-12-06 20:28:50 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_qa] GPU State: Allocated: 0.0MB | Reserved: 0.0MB | Free: 81152.8MB | Utilization: 0.0%
2025-12-06 20:28:50 - __main__ - INFO - Loading qa dataset (100 samples)...
2025-12-06 20:28:50 - src.data.dataset_loader - INFO - Loading MMLU dataset with 100 samples...
2025-12-06 20:34:04 - src.data.dataset_loader - INFO - Loaded 100 MMLU instances
2025-12-06 20:34:04 - src.utils.gpu - INFO - [dataset_loading] Duration: 314217.81ms | GPU Memory: 0.0MB -> 0.0MB (delta +0.0MB)
2025-12-06 20:34:04 - src.data.dataset_processor - INFO - Processing qa dataset to 6-option format...
2025-12-06 20:34:04 - src.data.dataset_processor - INFO - Processed 100 instances for qa
2025-12-06 20:34:04 - src.data.data_splitter - INFO - Splitting qa dataset (calibration: 50%, test: 50%)
2025-12-06 20:34:04 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:34:04 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:34:04 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:34:04 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:34:04 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 12, 'C': 12, 'D': 12}
2025-12-06 20:34:04 - src.data.data_splitter - INFO -   Test: {'A': 14, 'B': 13, 'C': 12, 'D': 12}
2025-12-06 20:34:04 - src.utils.gpu - INFO - [dataset_processing] Duration: 3.53ms | GPU Memory: 0.0MB -> 0.0MB (delta +0.0MB)
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:34:04 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for qa
2025-12-06 20:34:04 - __main__ - INFO - Loading model: stablelm-2-1.6b (float16)
2025-12-06 20:34:04 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float16 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:34:04 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:05 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:34:05 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:34:05 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:34:05 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:34:05 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:16 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:34:21 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:34:21 - src.models.model_loader - INFO -   GPU Memory: 3.06GB allocated, 3.25GB reserved
2025-12-06 20:34:21 - src.utils.gpu - INFO - [model_loading] Duration: 16911.95ms | GPU Memory: 0.0MB -> 3136.7MB (delta +3136.7MB)
2025-12-06 20:34:21 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 3136.7MB | Reserved: 3328.0MB | Free: 78016.1MB | Utilization: 4.0%
2025-12-06 20:34:21 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float16): 55
  Available memory: 73.70GB
  Model memory: 3.20GB
  Memory per batch item: 1.280GB
2025-12-06 20:34:21 - __main__ - INFO - Using batch size: 55
2025-12-06 20:34:21 - __main__ - INFO -   Strategy: base
2025-12-06 20:34:21 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: qa
2025-12-06 20:34:21 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:34:21 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:34:21 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float16
2025-12-06 20:34:21 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:34:21 - src.models.inference_engine - INFO -   Batch size: 55
2025-12-06 20:34:21 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:34:25 - src.utils.gpu - INFO - [inference_calibration] Duration: 3472.84ms | GPU Memory: 3136.7MB -> 3145.8MB (delta +9.1MB)
2025-12-06 20:34:28 - src.utils.gpu - INFO - [inference_test] Duration: 3046.27ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:34:28 - __main__ - INFO -     Inference: 6.52s for 100 samples (15.33 samples/sec)
2025-12-06 20:34:28 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:34:28 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:34:28 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:34:28 - src.utils.gpu - INFO - [probability_extraction] Duration: 4.10ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:34:28 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Threshold: 0.9877
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Score range: [0.0000, 1.0000]
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Average set size: 5.31
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Coverage rate: 92.16%
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 92.16% >= 90.00%
2025-12-06 20:34:28 - __main__ - INFO -     LAC: Acc=23.53%, CR=92.16%, SS=5.31
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:34:28 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Threshold: 1.0000
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Score range: [0.2487, 1.0000]
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:34:28 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Average set size: 6.00
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:34:28 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 20:34:28 - __main__ - INFO -     APS: Acc=23.53%, CR=100.00%, SS=6.00
2025-12-06 20:34:36 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float16
2025-12-06 20:34:37 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | qa | float16
2025-12-06 20:34:37 - __main__ - INFO - 
================================================================================
2025-12-06 20:34:37 - __main__ - INFO - Run 2/10: stablelm-2-1.6b | rc | float16
2025-12-06 20:34:37 - __main__ - INFO - ================================================================================
2025-12-06 20:34:37 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_rc] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 98.0%
2025-12-06 20:34:37 - __main__ - INFO - Loading rc dataset (100 samples)...
2025-12-06 20:34:37 - src.data.dataset_loader - INFO - Loading CosmosQA dataset with 100 samples...
2025-12-06 20:34:37 - src.data.dataset_loader - INFO - CosmosQA loaded successfully with standard method
2025-12-06 20:34:38 - src.data.dataset_loader - INFO - Loaded 100 CosmosQA instances
2025-12-06 20:34:38 - src.utils.gpu - INFO - [dataset_loading] Duration: 1587.84ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:34:38 - src.data.dataset_processor - INFO - Processing rc dataset to 6-option format...
2025-12-06 20:34:38 - src.data.dataset_processor - INFO - Processed 100 instances for rc
2025-12-06 20:34:38 - src.data.data_splitter - INFO - Splitting rc dataset (calibration: 50%, test: 50%)
2025-12-06 20:34:38 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:34:38 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:34:38 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:34:38 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:34:38 - src.data.data_splitter - INFO -   Calibration: {'A': 11, 'B': 15, 'C': 14, 'D': 9}
2025-12-06 20:34:38 - src.data.data_splitter - INFO -   Test: {'A': 11, 'B': 16, 'C': 14, 'D': 10}
2025-12-06 20:34:38 - src.utils.gpu - INFO - [dataset_processing] Duration: 3.27ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:34:38 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for rc
2025-12-06 20:34:38 - __main__ - INFO - Loading model: stablelm-2-1.6b (float16)
2025-12-06 20:34:38 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float16 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:34:38 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:38 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:34:38 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:34:38 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:34:38 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:34:38 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:39 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:34:42 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:34:42 - src.models.model_loader - INFO -   GPU Memory: 3.07GB allocated, 3.26GB reserved
2025-12-06 20:34:42 - src.utils.gpu - INFO - [model_loading] Duration: 3710.22ms | GPU Memory: 9.1MB -> 3145.8MB (delta +3136.7MB)
2025-12-06 20:34:42 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 3145.8MB | Reserved: 3336.0MB | Free: 78006.9MB | Utilization: 2.0%
2025-12-06 20:34:42 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float16): 55
  Available memory: 73.70GB
  Model memory: 3.20GB
  Memory per batch item: 1.280GB
2025-12-06 20:34:42 - __main__ - INFO - Using batch size: 55
2025-12-06 20:34:42 - __main__ - INFO -   Strategy: base
2025-12-06 20:34:42 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: rc
2025-12-06 20:34:42 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:34:42 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:34:42 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float16
2025-12-06 20:34:42 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:34:42 - src.models.inference_engine - INFO -   Batch size: 55
2025-12-06 20:34:42 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:34:43 - src.utils.gpu - INFO - [inference_calibration] Duration: 1400.68ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:34:45 - src.utils.gpu - INFO - [inference_test] Duration: 1404.26ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:34:45 - __main__ - INFO -     Inference: 2.81s for 100 samples (35.62 samples/sec)
2025-12-06 20:34:45 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:34:45 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:34:45 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:34:45 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.82ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:34:45 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Threshold: 0.9960
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Score range: [0.0118, 1.0000]
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Average set size: 5.53
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Coverage rate: 92.16%
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 92.16% >= 90.00%
2025-12-06 20:34:45 - __main__ - INFO -     LAC: Acc=25.49%, CR=92.16%, SS=5.53
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:34:45 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Threshold: 1.0000
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Score range: [0.2331, 1.0000]
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:34:45 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Average set size: 6.00
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:34:45 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 20:34:45 - __main__ - INFO -     APS: Acc=25.49%, CR=100.00%, SS=6.00
2025-12-06 20:34:50 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float16
2025-12-06 20:34:50 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | rc | float16
2025-12-06 20:34:50 - __main__ - INFO - 
================================================================================
2025-12-06 20:34:50 - __main__ - INFO - Run 3/10: stablelm-2-1.6b | ci | float16
2025-12-06 20:34:50 - __main__ - INFO - ================================================================================
2025-12-06 20:34:50 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_ci] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 77.0%
2025-12-06 20:34:50 - __main__ - INFO - Loading ci dataset (100 samples)...
2025-12-06 20:34:50 - src.data.dataset_loader - INFO - Loading HellaSwag dataset with 100 samples...
2025-12-06 20:34:53 - src.data.dataset_loader - INFO - Loaded 100 HellaSwag instances
2025-12-06 20:34:53 - src.utils.gpu - INFO - [dataset_loading] Duration: 3015.99ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:34:53 - src.data.dataset_processor - INFO - Processing ci dataset to 6-option format...
2025-12-06 20:34:53 - src.data.dataset_processor - INFO - Processed 100 instances for ci
2025-12-06 20:34:53 - src.data.data_splitter - INFO - Splitting ci dataset (calibration: 50%, test: 50%)
2025-12-06 20:34:53 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:34:53 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:34:53 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:34:53 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:34:53 - src.data.data_splitter - INFO -   Calibration: {'A': 14, 'B': 11, 'C': 9, 'D': 15}
2025-12-06 20:34:53 - src.data.data_splitter - INFO -   Test: {'A': 14, 'B': 11, 'C': 10, 'D': 16}
2025-12-06 20:34:53 - src.utils.gpu - INFO - [dataset_processing] Duration: 2.46ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:34:53 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for ci
2025-12-06 20:34:53 - __main__ - INFO - Loading model: stablelm-2-1.6b (float16)
2025-12-06 20:34:53 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float16 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:34:53 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:54 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:34:54 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:34:54 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:34:54 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:34:54 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:34:54 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:34:57 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:34:57 - src.models.model_loader - INFO -   GPU Memory: 3.07GB allocated, 3.26GB reserved
2025-12-06 20:34:57 - src.utils.gpu - INFO - [model_loading] Duration: 4156.42ms | GPU Memory: 9.1MB -> 3145.8MB (delta +3136.7MB)
2025-12-06 20:34:57 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 3145.8MB | Reserved: 3336.0MB | Free: 78006.9MB | Utilization: 2.0%
2025-12-06 20:34:57 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float16): 55
  Available memory: 73.70GB
  Model memory: 3.20GB
  Memory per batch item: 1.280GB
2025-12-06 20:34:57 - __main__ - INFO - Using batch size: 55
2025-12-06 20:34:57 - __main__ - INFO -   Strategy: base
2025-12-06 20:34:57 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: ci
2025-12-06 20:34:57 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:34:57 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:34:57 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float16
2025-12-06 20:34:57 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:34:57 - src.models.inference_engine - INFO -   Batch size: 55
2025-12-06 20:34:57 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:34:59 - src.utils.gpu - INFO - [inference_calibration] Duration: 1932.62ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:01 - src.utils.gpu - INFO - [inference_test] Duration: 1820.75ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:01 - __main__ - INFO -     Inference: 3.76s for 100 samples (26.62 samples/sec)
2025-12-06 20:35:01 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:35:01 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:35:01 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:35:01 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.28ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:01 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Threshold: 0.9914
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Score range: [0.1298, 1.0000]
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Average set size: 5.47
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Coverage rate: 94.12%
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 94.12% >= 90.00%
2025-12-06 20:35:01 - __main__ - INFO -     LAC: Acc=23.53%, CR=94.12%, SS=5.47
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:01 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Threshold: 0.9999
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Score range: [0.2433, 1.0000]
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:01 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Average set size: 5.88
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:01 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:35:01 - __main__ - INFO -     APS: Acc=23.53%, CR=96.08%, SS=5.88
2025-12-06 20:35:06 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float16
2025-12-06 20:35:06 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | ci | float16
2025-12-06 20:35:06 - __main__ - INFO - 
================================================================================
2025-12-06 20:35:06 - __main__ - INFO - Run 4/10: stablelm-2-1.6b | drs | float16
2025-12-06 20:35:06 - __main__ - INFO - ================================================================================
2025-12-06 20:35:06 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_drs] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 8.0%
2025-12-06 20:35:06 - __main__ - INFO - Loading drs dataset (100 samples)...
2025-12-06 20:35:06 - src.data.dataset_loader - INFO - Loading HaluDial dataset with 100 samples...
2025-12-06 20:35:07 - src.data.dataset_loader - INFO - Loaded 100 HaluDial instances
2025-12-06 20:35:07 - src.utils.gpu - INFO - [dataset_loading] Duration: 983.14ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:07 - src.data.dataset_processor - INFO - Processing drs dataset to 6-option format...
2025-12-06 20:35:07 - src.data.dataset_processor - INFO - Processed 100 instances for drs
2025-12-06 20:35:07 - src.data.dataset_processor - INFO - Option expansion statistics for drs:
2025-12-06 20:35:07 - src.data.dataset_processor - INFO -   Instances expanded (2→4 options): 100
2025-12-06 20:35:07 - src.data.dataset_processor - INFO -   Total options sampled: 200
2025-12-06 20:35:07 - src.data.dataset_processor - INFO -   Duplicate options avoided: 0
2025-12-06 20:35:07 - src.data.dataset_processor - INFO -   Fallback options used: 0
2025-12-06 20:35:07 - src.data.data_splitter - INFO - Splitting drs dataset (calibration: 50%, test: 50%)
2025-12-06 20:35:07 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:35:07 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:35:07 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:35:07 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:35:07 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 11, 'C': 11, 'D': 14}
2025-12-06 20:35:07 - src.data.data_splitter - INFO -   Test: {'A': 13, 'B': 11, 'C': 12, 'D': 15}
2025-12-06 20:35:07 - src.utils.gpu - INFO - [dataset_processing] Duration: 19.21ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO - Selecting 3 demonstrations using 'random' strategy
2025-12-06 20:35:07 - src.prompting.demonstration_manager - INFO - Selected and cached 3 demonstrations for drs
2025-12-06 20:35:07 - __main__ - INFO - Loading model: stablelm-2-1.6b (float16)
2025-12-06 20:35:07 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float16 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:35:07 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:07 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:35:07 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:35:07 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:35:07 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:35:07 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:07 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:35:11 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:35:11 - src.models.model_loader - INFO -   GPU Memory: 3.07GB allocated, 3.26GB reserved
2025-12-06 20:35:11 - src.utils.gpu - INFO - [model_loading] Duration: 3676.78ms | GPU Memory: 9.1MB -> 3145.8MB (delta +3136.7MB)
2025-12-06 20:35:11 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 3145.8MB | Reserved: 3336.0MB | Free: 78006.9MB | Utilization: 2.0%
2025-12-06 20:35:11 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float16): 55
  Available memory: 73.70GB
  Model memory: 3.20GB
  Memory per batch item: 1.280GB
2025-12-06 20:35:11 - __main__ - INFO - Using batch size: 55
2025-12-06 20:35:11 - __main__ - INFO -   Strategy: base
2025-12-06 20:35:11 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: drs
2025-12-06 20:35:11 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:35:11 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 3 demonstrations
2025-12-06 20:35:11 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float16
2025-12-06 20:35:11 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:35:11 - src.models.inference_engine - INFO -   Batch size: 55
2025-12-06 20:35:11 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:35:12 - src.utils.gpu - INFO - [inference_calibration] Duration: 951.80ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:13 - src.utils.gpu - INFO - [inference_test] Duration: 981.99ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:13 - __main__ - INFO -     Inference: 1.94s for 100 samples (51.65 samples/sec)
2025-12-06 20:35:13 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:35:13 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:35:13 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:35:13 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.81ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:13 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Threshold: 0.9831
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Score range: [0.3857, 1.0000]
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Average set size: 4.96
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Coverage rate: 80.39%
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: False
2025-12-06 20:35:13 - src.conformal.conformal_base - WARNING - ✗ Coverage guarantee NOT met: 80.39% < 90.00%
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - WARNING - LAC does not meet coverage guarantee: 80.39% < 90.00%
2025-12-06 20:35:13 - __main__ - INFO -     LAC: Acc=17.65%, CR=80.39%, SS=4.96
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:13 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Threshold: 0.9956
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Score range: [0.2745, 1.0000]
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Average set size: 5.33
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Coverage rate: 88.24%
2025-12-06 20:35:13 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: False
2025-12-06 20:35:13 - src.conformal.conformal_base - WARNING - ✗ Coverage guarantee NOT met: 88.24% < 90.00%
2025-12-06 20:35:13 - src.conformal.prediction_set_generator - WARNING - APS does not meet coverage guarantee: 88.24% < 90.00%
2025-12-06 20:35:13 - __main__ - INFO -     APS: Acc=17.65%, CR=88.24%, SS=5.33
2025-12-06 20:35:17 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float16
2025-12-06 20:35:17 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | drs | float16
2025-12-06 20:35:17 - __main__ - INFO - 
================================================================================
2025-12-06 20:35:17 - __main__ - INFO - Run 5/10: stablelm-2-1.6b | ds | float16
2025-12-06 20:35:17 - __main__ - INFO - ================================================================================
2025-12-06 20:35:17 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_ds] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 3.0%
2025-12-06 20:35:17 - __main__ - INFO - Loading ds dataset (100 samples)...
2025-12-06 20:35:17 - src.data.dataset_loader - INFO - Loading HaluSum dataset with 100 samples...
2025-12-06 20:35:18 - src.data.dataset_loader - INFO - Loaded 100 HaluSum instances
2025-12-06 20:35:18 - src.utils.gpu - INFO - [dataset_loading] Duration: 707.75ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:18 - src.data.dataset_processor - INFO - Processing ds dataset to 6-option format...
2025-12-06 20:35:18 - src.data.dataset_processor - INFO - Processed 100 instances for ds
2025-12-06 20:35:18 - src.data.dataset_processor - INFO - Option expansion statistics for ds:
2025-12-06 20:35:18 - src.data.dataset_processor - INFO -   Instances expanded (2→4 options): 100
2025-12-06 20:35:18 - src.data.dataset_processor - INFO -   Total options sampled: 200
2025-12-06 20:35:18 - src.data.dataset_processor - INFO -   Duplicate options avoided: 0
2025-12-06 20:35:18 - src.data.dataset_processor - INFO -   Fallback options used: 0
2025-12-06 20:35:18 - src.data.data_splitter - INFO - Splitting ds dataset (calibration: 50%, test: 50%)
2025-12-06 20:35:18 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:35:18 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:35:18 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:35:18 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:35:18 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 11, 'C': 11, 'D': 14}
2025-12-06 20:35:18 - src.data.data_splitter - INFO -   Test: {'A': 13, 'B': 11, 'C': 12, 'D': 15}
2025-12-06 20:35:18 - src.utils.gpu - INFO - [dataset_processing] Duration: 48.43ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO - Selecting 1 demonstrations using 'random' strategy
2025-12-06 20:35:18 - src.prompting.demonstration_manager - INFO - Selected and cached 1 demonstrations for ds
2025-12-06 20:35:18 - __main__ - INFO - Loading model: stablelm-2-1.6b (float16)
2025-12-06 20:35:18 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float16 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:35:18 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:18 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:35:18 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:35:18 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:35:18 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:35:18 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:19 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:35:22 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:35:22 - src.models.model_loader - INFO -   GPU Memory: 3.07GB allocated, 3.26GB reserved
2025-12-06 20:35:22 - src.utils.gpu - INFO - [model_loading] Duration: 3933.28ms | GPU Memory: 9.1MB -> 3145.8MB (delta +3136.7MB)
2025-12-06 20:35:22 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 3145.8MB | Reserved: 3336.0MB | Free: 78006.9MB | Utilization: 10.0%
2025-12-06 20:35:22 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float16): 55
  Available memory: 73.70GB
  Model memory: 3.20GB
  Memory per batch item: 1.280GB
2025-12-06 20:35:22 - __main__ - INFO - Using batch size: 55
2025-12-06 20:35:22 - __main__ - INFO -   Strategy: base
2025-12-06 20:35:22 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: ds
2025-12-06 20:35:22 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:35:22 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 1 demonstrations
2025-12-06 20:35:22 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float16
2025-12-06 20:35:22 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:35:22 - src.models.inference_engine - INFO -   Batch size: 55
2025-12-06 20:35:22 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:35:27 - src.utils.gpu - INFO - [inference_calibration] Duration: 5444.68ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:33 - src.utils.gpu - INFO - [inference_test] Duration: 5912.37ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:33 - __main__ - INFO -     Inference: 11.36s for 100 samples (8.80 samples/sec)
2025-12-06 20:35:33 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:35:33 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:35:33 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:35:33 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.63ms | GPU Memory: 3145.8MB -> 3145.8MB (delta +0.0MB)
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:33 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Threshold: 0.9637
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Score range: [0.2014, 0.9991]
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Average set size: 5.20
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:35:33 - __main__ - INFO -     LAC: Acc=21.57%, CR=96.08%, SS=5.20
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:33 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Threshold: 0.9874
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Score range: [0.2267, 1.0000]
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:33 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Average set size: 5.75
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:33 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 20:35:33 - __main__ - INFO -     APS: Acc=21.57%, CR=100.00%, SS=5.75
2025-12-06 20:35:40 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float16
2025-12-06 20:35:40 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | ds | float16
2025-12-06 20:35:40 - __main__ - INFO - 
================================================================================
2025-12-06 20:35:40 - __main__ - INFO - Run 6/10: stablelm-2-1.6b | qa | float32
2025-12-06 20:35:40 - __main__ - INFO - ================================================================================
2025-12-06 20:35:40 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_qa] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 0.0%
2025-12-06 20:35:40 - __main__ - INFO - Loading qa dataset (100 samples)...
2025-12-06 20:35:40 - src.data.dataset_loader - INFO - Loading MMLU dataset with 100 samples...
2025-12-06 20:35:44 - src.data.dataset_loader - INFO - Loaded 100 MMLU instances
2025-12-06 20:35:44 - src.utils.gpu - INFO - [dataset_loading] Duration: 4410.21ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:44 - src.data.dataset_processor - INFO - Processing qa dataset to 6-option format...
2025-12-06 20:35:44 - src.data.dataset_processor - INFO - Processed 100 instances for qa
2025-12-06 20:35:44 - src.data.data_splitter - INFO - Splitting qa dataset (calibration: 50%, test: 50%)
2025-12-06 20:35:44 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:35:44 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:35:44 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:35:44 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:35:44 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 12, 'C': 12, 'D': 12}
2025-12-06 20:35:44 - src.data.data_splitter - INFO -   Test: {'A': 14, 'B': 13, 'C': 12, 'D': 12}
2025-12-06 20:35:44 - src.utils.gpu - INFO - [dataset_processing] Duration: 2.70ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:35:44 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for qa
2025-12-06 20:35:44 - __main__ - INFO - Loading model: stablelm-2-1.6b (float32)
2025-12-06 20:35:44 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float32 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:35:44 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:45 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:35:45 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:35:45 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:35:45 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:35:45 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:35:45 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:35:48 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:35:48 - src.models.model_loader - INFO -   GPU Memory: 6.14GB allocated, 6.29GB reserved
2025-12-06 20:35:48 - src.utils.gpu - INFO - [model_loading] Duration: 3934.58ms | GPU Memory: 9.1MB -> 6282.5MB (delta +6273.3MB)
2025-12-06 20:35:48 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 6282.5MB | Reserved: 6446.0MB | Free: 74870.3MB | Utilization: 19.0%
2025-12-06 20:35:48 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float32): 26
  Available memory: 73.70GB
  Model memory: 6.40GB
  Memory per batch item: 2.560GB
2025-12-06 20:35:48 - __main__ - INFO - Using batch size: 26
2025-12-06 20:35:48 - __main__ - INFO -   Strategy: base
2025-12-06 20:35:48 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: qa
2025-12-06 20:35:48 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:35:48 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:35:48 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float32
2025-12-06 20:35:48 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:35:48 - src.models.inference_engine - INFO -   Batch size: 26
2025-12-06 20:35:48 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:35:51 - src.utils.gpu - INFO - [inference_calibration] Duration: 2680.51ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:35:53 - src.utils.gpu - INFO - [inference_test] Duration: 1747.32ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:35:53 - __main__ - INFO -     Inference: 4.43s for 100 samples (22.58 samples/sec)
2025-12-06 20:35:53 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:35:53 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:35:53 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:35:53 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.63ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:53 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Threshold: 0.9872
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Score range: [0.4063, 1.0000]
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Average set size: 5.29
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Coverage rate: 90.20%
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 90.20% >= 90.00%
2025-12-06 20:35:53 - __main__ - INFO -     LAC: Acc=21.57%, CR=90.20%, SS=5.29
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:35:53 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Threshold: 0.9981
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Score range: [0.2473, 1.0000]
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:35:53 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Average set size: 5.69
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:35:53 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:35:53 - __main__ - INFO -     APS: Acc=21.57%, CR=96.08%, SS=5.69
2025-12-06 20:36:04 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float32
2025-12-06 20:36:04 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | qa | float32
2025-12-06 20:36:04 - __main__ - INFO - 
================================================================================
2025-12-06 20:36:04 - __main__ - INFO - Run 7/10: stablelm-2-1.6b | rc | float32
2025-12-06 20:36:04 - __main__ - INFO - ================================================================================
2025-12-06 20:36:04 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_rc] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 5.0%
2025-12-06 20:36:04 - __main__ - INFO - Loading rc dataset (100 samples)...
2025-12-06 20:36:04 - src.data.dataset_loader - INFO - Loading CosmosQA dataset with 100 samples...
2025-12-06 20:36:30 - src.data.dataset_loader - INFO - CosmosQA loaded successfully with standard method
2025-12-06 20:36:31 - src.data.dataset_loader - INFO - Loaded 100 CosmosQA instances
2025-12-06 20:36:31 - src.utils.gpu - INFO - [dataset_loading] Duration: 27250.17ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:36:31 - src.data.dataset_processor - INFO - Processing rc dataset to 6-option format...
2025-12-06 20:36:31 - src.data.dataset_processor - INFO - Processed 100 instances for rc
2025-12-06 20:36:31 - src.data.data_splitter - INFO - Splitting rc dataset (calibration: 50%, test: 50%)
2025-12-06 20:36:31 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:36:31 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:36:31 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:36:31 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:36:31 - src.data.data_splitter - INFO -   Calibration: {'A': 11, 'B': 15, 'C': 14, 'D': 9}
2025-12-06 20:36:31 - src.data.data_splitter - INFO -   Test: {'A': 11, 'B': 16, 'C': 14, 'D': 10}
2025-12-06 20:36:31 - src.utils.gpu - INFO - [dataset_processing] Duration: 2.83ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:36:31 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for rc
2025-12-06 20:36:31 - __main__ - INFO - Loading model: stablelm-2-1.6b (float32)
2025-12-06 20:36:31 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float32 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:36:31 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:36:32 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:36:32 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:36:32 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:36:32 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:36:32 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:36:32 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:36:36 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:36:36 - src.models.model_loader - INFO -   GPU Memory: 6.14GB allocated, 6.29GB reserved
2025-12-06 20:36:36 - src.utils.gpu - INFO - [model_loading] Duration: 4527.67ms | GPU Memory: 9.1MB -> 6282.5MB (delta +6273.3MB)
2025-12-06 20:36:36 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 6282.5MB | Reserved: 6446.0MB | Free: 74870.3MB | Utilization: 12.0%
2025-12-06 20:36:36 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float32): 26
  Available memory: 73.70GB
  Model memory: 6.40GB
  Memory per batch item: 2.560GB
2025-12-06 20:36:36 - __main__ - INFO - Using batch size: 26
2025-12-06 20:36:36 - __main__ - INFO -   Strategy: base
2025-12-06 20:36:36 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: rc
2025-12-06 20:36:36 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:36:36 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:36:36 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float32
2025-12-06 20:36:36 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:36:36 - src.models.inference_engine - INFO -   Batch size: 26
2025-12-06 20:36:36 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:36:37 - src.utils.gpu - INFO - [inference_calibration] Duration: 1475.53ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:36:39 - src.utils.gpu - INFO - [inference_test] Duration: 1590.73ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:36:39 - __main__ - INFO -     Inference: 3.07s for 100 samples (32.59 samples/sec)
2025-12-06 20:36:39 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:36:39 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:36:39 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:36:39 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.67ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:36:39 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Threshold: 0.9739
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Score range: [0.3089, 1.0000]
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Average set size: 4.67
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Coverage rate: 84.31%
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: False
2025-12-06 20:36:39 - src.conformal.conformal_base - WARNING - ✗ Coverage guarantee NOT met: 84.31% < 90.00%
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - WARNING - LAC does not meet coverage guarantee: 84.31% < 90.00%
2025-12-06 20:36:39 - __main__ - INFO -     LAC: Acc=19.61%, CR=84.31%, SS=4.67
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:36:39 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Threshold: 0.9975
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Score range: [0.2285, 1.0000]
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:36:39 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Average set size: 5.78
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:36:39 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:36:39 - __main__ - INFO -     APS: Acc=19.61%, CR=96.08%, SS=5.78
2025-12-06 20:36:51 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float32
2025-12-06 20:36:51 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | rc | float32
2025-12-06 20:36:51 - __main__ - INFO - 
================================================================================
2025-12-06 20:36:51 - __main__ - INFO - Run 8/10: stablelm-2-1.6b | ci | float32
2025-12-06 20:36:51 - __main__ - INFO - ================================================================================
2025-12-06 20:36:51 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_ci] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 6.0%
2025-12-06 20:36:51 - __main__ - INFO - Loading ci dataset (100 samples)...
2025-12-06 20:36:51 - src.data.dataset_loader - INFO - Loading HellaSwag dataset with 100 samples...
2025-12-06 20:36:54 - src.data.dataset_loader - INFO - Loaded 100 HellaSwag instances
2025-12-06 20:36:54 - src.utils.gpu - INFO - [dataset_loading] Duration: 2746.85ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:36:54 - src.data.dataset_processor - INFO - Processing ci dataset to 6-option format...
2025-12-06 20:36:54 - src.data.dataset_processor - INFO - Processed 100 instances for ci
2025-12-06 20:36:54 - src.data.data_splitter - INFO - Splitting ci dataset (calibration: 50%, test: 50%)
2025-12-06 20:36:54 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:36:54 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:36:54 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:36:54 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:36:54 - src.data.data_splitter - INFO -   Calibration: {'A': 14, 'B': 11, 'C': 9, 'D': 15}
2025-12-06 20:36:54 - src.data.data_splitter - INFO -   Test: {'A': 14, 'B': 11, 'C': 10, 'D': 16}
2025-12-06 20:36:54 - src.utils.gpu - INFO - [dataset_processing] Duration: 3.83ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO - Selecting 5 demonstrations using 'random' strategy
2025-12-06 20:36:54 - src.prompting.demonstration_manager - INFO - Selected and cached 5 demonstrations for ci
2025-12-06 20:36:54 - __main__ - INFO - Loading model: stablelm-2-1.6b (float32)
2025-12-06 20:36:54 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float32 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:36:54 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:36:54 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:36:54 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:36:54 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:36:54 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:36:54 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:36:54 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:36:57 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:36:57 - src.models.model_loader - INFO -   GPU Memory: 6.14GB allocated, 6.29GB reserved
2025-12-06 20:36:57 - src.utils.gpu - INFO - [model_loading] Duration: 3661.79ms | GPU Memory: 9.1MB -> 6282.5MB (delta +6273.3MB)
2025-12-06 20:36:57 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 6282.5MB | Reserved: 6446.0MB | Free: 74870.3MB | Utilization: 2.0%
2025-12-06 20:36:57 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float32): 26
  Available memory: 73.70GB
  Model memory: 6.40GB
  Memory per batch item: 2.560GB
2025-12-06 20:36:57 - __main__ - INFO - Using batch size: 26
2025-12-06 20:36:57 - __main__ - INFO -   Strategy: base
2025-12-06 20:36:57 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: ci
2025-12-06 20:36:57 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:36:57 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 5 demonstrations
2025-12-06 20:36:57 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float32
2025-12-06 20:36:57 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:36:57 - src.models.inference_engine - INFO -   Batch size: 26
2025-12-06 20:36:57 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:36:59 - src.utils.gpu - INFO - [inference_calibration] Duration: 1814.02ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:01 - src.utils.gpu - INFO - [inference_test] Duration: 1911.41ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:01 - __main__ - INFO -     Inference: 3.73s for 100 samples (26.83 samples/sec)
2025-12-06 20:37:01 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:37:01 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:37:01 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:37:01 - src.utils.gpu - INFO - [probability_extraction] Duration: 4.19ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:01 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Threshold: 0.9914
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Score range: [0.0209, 0.9993]
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Average set size: 5.65
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Coverage rate: 94.12%
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 94.12% >= 90.00%
2025-12-06 20:37:01 - __main__ - INFO -     LAC: Acc=25.49%, CR=94.12%, SS=5.65
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:01 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Threshold: 0.9922
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Score range: [0.2436, 1.0000]
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:01 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Average set size: 5.75
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:01 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:37:01 - __main__ - INFO -     APS: Acc=25.49%, CR=96.08%, SS=5.75
2025-12-06 20:37:11 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float32
2025-12-06 20:37:11 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | ci | float32
2025-12-06 20:37:11 - __main__ - INFO - 
================================================================================
2025-12-06 20:37:11 - __main__ - INFO - Run 9/10: stablelm-2-1.6b | drs | float32
2025-12-06 20:37:11 - __main__ - INFO - ================================================================================
2025-12-06 20:37:11 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_drs] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 100.0%
2025-12-06 20:37:11 - __main__ - INFO - Loading drs dataset (100 samples)...
2025-12-06 20:37:11 - src.data.dataset_loader - INFO - Loading HaluDial dataset with 100 samples...
2025-12-06 20:37:17 - src.data.dataset_loader - INFO - Loaded 100 HaluDial instances
2025-12-06 20:37:17 - src.utils.gpu - INFO - [dataset_loading] Duration: 5634.62ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:37:17 - src.data.dataset_processor - INFO - Processing drs dataset to 6-option format...
2025-12-06 20:37:17 - src.data.dataset_processor - INFO - Processed 100 instances for drs
2025-12-06 20:37:17 - src.data.dataset_processor - INFO - Option expansion statistics for drs:
2025-12-06 20:37:17 - src.data.dataset_processor - INFO -   Instances expanded (2→4 options): 100
2025-12-06 20:37:17 - src.data.dataset_processor - INFO -   Total options sampled: 200
2025-12-06 20:37:17 - src.data.dataset_processor - INFO -   Duplicate options avoided: 0
2025-12-06 20:37:17 - src.data.dataset_processor - INFO -   Fallback options used: 0
2025-12-06 20:37:17 - src.data.data_splitter - INFO - Splitting drs dataset (calibration: 50%, test: 50%)
2025-12-06 20:37:17 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:37:17 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:37:17 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:37:17 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:37:17 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 11, 'C': 11, 'D': 14}
2025-12-06 20:37:17 - src.data.data_splitter - INFO -   Test: {'A': 13, 'B': 11, 'C': 12, 'D': 15}
2025-12-06 20:37:17 - src.utils.gpu - INFO - [dataset_processing] Duration: 18.62ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO - Selecting 3 demonstrations using 'random' strategy
2025-12-06 20:37:17 - src.prompting.demonstration_manager - INFO - Selected and cached 3 demonstrations for drs
2025-12-06 20:37:17 - __main__ - INFO - Loading model: stablelm-2-1.6b (float32)
2025-12-06 20:37:17 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float32 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:37:17 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:37:17 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:37:17 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:37:17 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:37:17 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:37:17 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:37:17 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:37:21 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:37:21 - src.models.model_loader - INFO -   GPU Memory: 6.14GB allocated, 6.29GB reserved
2025-12-06 20:37:21 - src.utils.gpu - INFO - [model_loading] Duration: 4475.54ms | GPU Memory: 9.1MB -> 6282.5MB (delta +6273.3MB)
2025-12-06 20:37:21 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 6282.5MB | Reserved: 6446.0MB | Free: 74870.3MB | Utilization: 6.0%
2025-12-06 20:37:21 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float32): 26
  Available memory: 73.70GB
  Model memory: 6.40GB
  Memory per batch item: 2.560GB
2025-12-06 20:37:21 - __main__ - INFO - Using batch size: 26
2025-12-06 20:37:21 - __main__ - INFO -   Strategy: base
2025-12-06 20:37:21 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: drs
2025-12-06 20:37:21 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:37:21 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 3 demonstrations
2025-12-06 20:37:21 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float32
2025-12-06 20:37:21 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:37:21 - src.models.inference_engine - INFO -   Batch size: 26
2025-12-06 20:37:21 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:37:22 - src.utils.gpu - INFO - [inference_calibration] Duration: 1115.51ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:23 - src.utils.gpu - INFO - [inference_test] Duration: 1018.09ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:23 - __main__ - INFO -     Inference: 2.14s for 100 samples (46.82 samples/sec)
2025-12-06 20:37:23 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:37:23 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:37:23 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:37:23 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.40ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:23 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Threshold: 0.9947
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Score range: [0.4098, 1.0000]
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Average set size: 5.53
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Coverage rate: 92.16%
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 92.16% >= 90.00%
2025-12-06 20:37:23 - __main__ - INFO -     LAC: Acc=7.84%, CR=92.16%, SS=5.53
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:23 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Threshold: 1.0000
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Score range: [0.2701, 1.0000]
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:23 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Average set size: 6.00
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:23 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 20:37:23 - __main__ - INFO -     APS: Acc=7.84%, CR=100.00%, SS=6.00
2025-12-06 20:37:33 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float32
2025-12-06 20:37:33 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | drs | float32
2025-12-06 20:37:33 - __main__ - INFO - 
================================================================================
2025-12-06 20:37:33 - __main__ - INFO - Run 10/10: stablelm-2-1.6b | ds | float32
2025-12-06 20:37:33 - __main__ - INFO - ================================================================================
2025-12-06 20:37:33 - src.utils.gpu - INFO - [start_stablelm-2-1.6b_ds] GPU State: Allocated: 9.1MB | Reserved: 22.0MB | Free: 81143.6MB | Utilization: 100.0%
2025-12-06 20:37:33 - __main__ - INFO - Loading ds dataset (100 samples)...
2025-12-06 20:37:33 - src.data.dataset_loader - INFO - Loading HaluSum dataset with 100 samples...
2025-12-06 20:37:34 - src.data.dataset_loader - INFO - Loaded 100 HaluSum instances
2025-12-06 20:37:34 - src.utils.gpu - INFO - [dataset_loading] Duration: 595.66ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:37:34 - src.data.dataset_processor - INFO - Processing ds dataset to 6-option format...
2025-12-06 20:37:34 - src.data.dataset_processor - INFO - Processed 100 instances for ds
2025-12-06 20:37:34 - src.data.dataset_processor - INFO - Option expansion statistics for ds:
2025-12-06 20:37:34 - src.data.dataset_processor - INFO -   Instances expanded (2→4 options): 100
2025-12-06 20:37:34 - src.data.dataset_processor - INFO -   Total options sampled: 200
2025-12-06 20:37:34 - src.data.dataset_processor - INFO -   Duplicate options avoided: 0
2025-12-06 20:37:34 - src.data.dataset_processor - INFO -   Fallback options used: 0
2025-12-06 20:37:34 - src.data.data_splitter - INFO - Splitting ds dataset (calibration: 50%, test: 50%)
2025-12-06 20:37:34 - src.data.data_splitter - INFO - Split complete:
2025-12-06 20:37:34 - src.data.data_splitter - INFO -   Calibration: 49 instances
2025-12-06 20:37:34 - src.data.data_splitter - INFO -   Test: 51 instances
2025-12-06 20:37:34 - src.data.data_splitter - INFO - Answer distribution:
2025-12-06 20:37:34 - src.data.data_splitter - INFO -   Calibration: {'A': 13, 'B': 11, 'C': 11, 'D': 14}
2025-12-06 20:37:34 - src.data.data_splitter - INFO -   Test: {'A': 13, 'B': 11, 'C': 12, 'D': 15}
2025-12-06 20:37:34 - src.utils.gpu - INFO - [dataset_processing] Duration: 48.19ms | GPU Memory: 9.1MB -> 9.1MB (delta +0.0MB)
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationSelector
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO -   Strategy: random
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO -   Num demonstrations: 5
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO - Initialized DemonstrationManager
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO - Selecting 1 demonstrations using 'random' strategy
2025-12-06 20:37:34 - src.prompting.demonstration_manager - INFO - Selected and cached 1 demonstrations for ds
2025-12-06 20:37:34 - __main__ - INFO - Loading model: stablelm-2-1.6b (float32)
2025-12-06 20:37:34 - src.models.model_loader - INFO - Loading model: stablelm-2-1.6b_float32 (stabilityai/stablelm-2-1_6b)
2025-12-06 20:37:34 - src.models.model_loader - INFO - Loading tokenizer from stabilityai/stablelm-2-1_6b
2025-12-06 20:37:34 - src.models.model_loader - INFO - Tokenizer loaded successfully
2025-12-06 20:37:34 - src.models.model_loader - INFO -   Vocab size: 100289
2025-12-06 20:37:34 - src.models.model_loader - INFO -   Padding side: left
2025-12-06 20:37:34 - src.models.model_loader - INFO -   PAD token: <|endoftext|> (ID: 100257)
2025-12-06 20:37:34 - src.models.model_loader - INFO - Loading model from stabilityai/stablelm-2-1_6b
2025-12-06 20:37:34 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-12-06 20:37:38 - src.models.model_loader - INFO - Model loaded successfully
2025-12-06 20:37:38 - src.models.model_loader - INFO -   GPU Memory: 6.14GB allocated, 6.29GB reserved
2025-12-06 20:37:38 - src.utils.gpu - INFO - [model_loading] Duration: 3951.44ms | GPU Memory: 9.1MB -> 6282.5MB (delta +6273.3MB)
2025-12-06 20:37:38 - src.utils.gpu - INFO - [after_model_load_stablelm-2-1.6b] GPU State: Allocated: 6282.5MB | Reserved: 6446.0MB | Free: 74870.3MB | Utilization: 3.0%
2025-12-06 20:37:38 - src.utils.gpu - INFO - Optimal batch size for 1.6B model (float32): 26
  Available memory: 73.70GB
  Model memory: 6.40GB
  Memory per batch item: 2.560GB
2025-12-06 20:37:38 - __main__ - INFO - Using batch size: 26
2025-12-06 20:37:38 - __main__ - INFO -   Strategy: base
2025-12-06 20:37:38 - src.prompting.prompt_builder - INFO - Initialized PromptBuilder for task: ds
2025-12-06 20:37:38 - src.prompting.prompt_builder - INFO -   Available strategies: ['base', 'shared_instruction', 'task_specific']
2025-12-06 20:37:38 - src.prompting.prompt_builder - INFO - Building 100 prompts using 'base' strategy with 1 demonstrations
2025-12-06 20:37:38 - src.models.inference_engine - INFO - Initialized InferenceEngine for stablelm-2-1.6b_float32
2025-12-06 20:37:38 - src.models.inference_engine - INFO -   Device: cuda:0
2025-12-06 20:37:38 - src.models.inference_engine - INFO -   Batch size: 26
2025-12-06 20:37:38 - src.models.inference_engine - INFO -   Option tokens: {'A': 32, 'B': 33, 'C': 34, 'D': 35, 'E': 36, 'F': 37}
2025-12-06 20:37:41 - src.utils.gpu - INFO - [inference_calibration] Duration: 3414.48ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:45 - src.utils.gpu - INFO - [inference_test] Duration: 3448.02ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:45 - __main__ - INFO -     Inference: 6.87s for 100 samples (14.57 samples/sec)
2025-12-06 20:37:45 - src.models.probability_extractor - INFO - Initialized ProbabilityExtractor
2025-12-06 20:37:45 - src.models.probability_extractor - INFO -   Temperature: 1.0
2025-12-06 20:37:45 - src.models.probability_extractor - INFO -   Calibration method: None
2025-12-06 20:37:45 - src.utils.gpu - INFO - [probability_extraction] Duration: 3.36ms | GPU Memory: 6282.5MB -> 6282.5MB (delta +0.0MB)
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Initialized LACScorer
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:45 - src.conformal.scorers - INFO - Initialized LAC (Least Ambiguous set-valued Classifiers) scorer
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Methods: ['lac']
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Calibrating LAC...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Threshold: 0.9636
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Score range: [0.1995, 0.9991]
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using LAC...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Average set size: 5.20
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Coverage rate: 96.08%
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 96.08% >= 90.00%
2025-12-06 20:37:45 - __main__ - INFO -     LAC: Acc=21.57%, CR=96.08%, SS=5.20
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Initialized APSScorer
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Alpha: 0.1
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Target coverage: 90.0%
2025-12-06 20:37:45 - src.conformal.scorers - INFO - Initialized APS (Adaptive Prediction Sets) scorer
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Initialized PredictionSetGenerator
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Methods: ['aps']
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Alpha: 0.1
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Aggregation: separate
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Calibrating 1 conformal predictors...
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO -   Calibrating APS...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Calibrating with 49 samples...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Calibration complete
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Threshold: 0.9831
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Score range: [0.2273, 1.0000]
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Calibration complete
2025-12-06 20:37:45 - src.conformal.prediction_set_generator - INFO - Generating prediction sets using APS...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Generating prediction sets for 51 test instances...
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - Prediction complete
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Average set size: 5.65
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Coverage rate: 100.00%
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO -   Meets coverage guarantee: True
2025-12-06 20:37:45 - src.conformal.conformal_base - INFO - [PASS] Coverage guarantee met: 100.00% >= 90.00%
2025-12-06 20:37:45 - __main__ - INFO -     APS: Acc=21.57%, CR=100.00%, SS=5.65
2025-12-06 20:37:55 - src.models.model_loader - INFO - Unloaded model: stablelm-2-1.6b_float32
2025-12-06 20:37:55 - __main__ - INFO - Checkpoint saved after completing: stablelm-2-1.6b | ds | float32
2025-12-06 20:37:56 - src.visualization.result_visualizer - INFO - Generating all visualizations...
2025-12-06 20:37:56 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_accuracy.png
2025-12-06 20:37:57 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_coverage_rate.png
2025-12-06 20:37:57 - src.visualization.result_visualizer - INFO - Saved heatmap to outputs/results/figures/heatmap_avg_set_size.png
2025-12-06 20:37:59 - src.visualization.result_visualizer - INFO - Saved dashboard to outputs/results/figures/dashboard.png
2025-12-06 20:37:59 - src.visualization.result_visualizer - INFO - Saved bar chart to outputs/results/figures/bar_comparison_accuracy.png
2025-12-06 20:38:00 - src.visualization.result_visualizer - INFO - Saved bar chart to outputs/results/figures/bar_comparison_avg_set_size.png
2025-12-06 20:38:00 - src.visualization.result_visualizer - INFO - Saved radar chart to outputs/results/figures/radar_chart.png
2025-12-06 20:38:01 - src.visualization.result_visualizer - INFO - Saved uncertainty analysis to outputs/results/figures/uncertainty_analysis.png
2025-12-06 20:38:01 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary.md
2025-12-06 20:38:01 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary_lac.md
2025-12-06 20:38:01 - src.visualization.result_visualizer - INFO - Saved summary table to outputs/results/figures/results_summary_aps.md
2025-12-06 20:38:02 - src.visualization.result_visualizer - INFO - Saved dtype comparison to outputs/results/figures/dtype_comparison_accuracy.png
2025-12-06 20:38:03 - src.visualization.result_visualizer - INFO - Saved dtype comparison to outputs/results/figures/dtype_comparison_avg_set_size.png
2025-12-06 20:38:03 - src.visualization.result_visualizer - INFO - All visualizations saved to outputs/results/figures
2025-12-06 20:38:03 - __main__ - INFO - Visualizations saved to: outputs/results/figures
2025-12-06 20:38:05 - src.utils.gpu - INFO - Stopped GPU monitoring. Collected 273 snapshots.
2025-12-06 20:38:05 - src.utils.gpu - INFO - Saved GPU profiling report to outputs/results/gpu_profile_20251206_202834.json
2025-12-06 20:38:05 - __main__ - INFO - GPU profiling report saved to: outputs/results/gpu_profile_20251206_202834.json
2025-12-06 20:38:05 - __main__ - INFO - 
================================================================================
2025-12-06 20:38:05 - __main__ - INFO - BENCHMARK COMPLETE
2025-12-06 20:38:05 - __main__ - INFO - ================================================================================
2025-12-06 20:38:05 - __main__ - INFO - Total time: 9.22 minutes
2025-12-06 20:38:05 - __main__ - INFO - Results saved to: outputs/results
2025-12-06 20:38:05 - __main__ - INFO - Benchmark completed successfully
2025-12-06 20:38:05 - __main__ - INFO - Total runs: 20
2025-12-06 20:38:05 - __main__ - INFO - Overall accuracy: 20.78%
2025-12-06 20:38:05 - __main__ - INFO - Overall coverage: 94.22%
2025-12-06 20:38:05 - __main__ - INFO - Log file saved to: outputs/results/logs/benchmark_20251206_202834.log
